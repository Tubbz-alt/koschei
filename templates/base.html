<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>{% block title %}Koschei{% endblock %}</title>
        <link rel="stylesheet" type="text/css" media="screen" title="Koschei Style"
        href="{{ url_for('static', filename='koschei.css') }}?version={{ koschei_version }}"/>

        <script type="text/javascript" src="{{ url_for('static', filename='jquery.min.js') }}"></script>
        <script type="text/javascript">
            $(function() {
                // Hide empty collection columns of package table
                $('.package-table th').each(function(i) {
                    if (this.classList.contains('collection-column')) {
                        var columnCells = $(this).parents('table').find('tr td:nth-child(' + (i + 1) + ')')
                        var columnEmpty = true;
                        columnCells.each(function() {
                            columnEmpty &= this.innerHTML == '';
                        });
                        if (columnEmpty) {
                            $(this).hide();
                            columnCells.hide();
                        }
                    }
                });
            });
        </script>

        {% if fedmenu_url is defined %}
        <script type="text/javascript" src="{{fedmenu_url}}/js/fedmenu.js"></script>
        <script type="text/javascript" src="{{fedmenu_url}}/js/fedora-libravatar.js"></script>
        <script type="text/javascript">
            fedmenu({
                'url': '{{fedmenu_data_url}}',
                'mimeType': 'application/javascript',
                'position': 'bottom-right',
                {% if package is defined %}
                'package': '{{ package.name }}',
                {% endif %}
                {% if user is defined %}
                'user': '{{ user.name }}',
                {% endif %}
            });
        </script>
        {% endif %}

    </head>
    <body>
        <div id="wrap">
            <div id="innerwrap">
                <div id="header">
                    <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Koschei Logo" id="kojiLogo"/>
                    <form action="{{ url_for('search') }}" id="headerSearch">
                        <!--<select name="type">
                            <option value="package">Packages</option>
                            <option value="group">Groups</option>
                        </select>-->
                        <input type="text" name="q"/>
                        <input type="submit" value="Search"/>
                    </form>
                </div>

                <div id="mainNav">
                    <h4 class="hide">Main Site Links:</h4>
                    <ul>
                        {% for tab in get_tabs() %}
                        <li {% if g.current_tab == tab %}id="activeTab"{% endif %}>
                            {% if not tab.requires_user or g.user %}
                            <a href="{{ tab.url }}">{{ tab.name }}</a>
                            {% else %}
                            <div>{{ tab.name }}</div>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                </div>

                <span id="loginInfo">
                    {% block statusline %}
                    {% endblock %}
                    {% if g.user %}
                    <span>Logged in as {{ g.user.name }}</span>
                    <a href="{{ url_for('logout') }}">logout</a>
                    {% else %}
                    <a href="{{ url_for('login', next=request.url) }}">login</a>
                    {% endif %}
                </span>

                {% with messages = get_flashed_messages() %}
                {% if messages %}
                <ul class=flashes>
                    {% for message in messages %}
                    <li>{{ message }}</li>
                    {% endfor %}
                </ul>
                {% endif %}
                {% endwith %}

                {% for notice in get_global_notices() %}
                <h3 class="notice">{{ notice }}</h3>
                {% endfor %}

                <div id="content">
                    {% block content %}
                    {% endblock %}
                </div>
                <p id="footer">
                    Koschei version {{ koschei_version }}<br/>
                    Authors: Michael Simacek, Mikolaj Izdebski<br/>
                    Copyright &copy; 2014-2017 Red Hat.<br/>
                    <a href="https://github.com/msimacek/koschei/issues">Reporting bugs.</a>
                    You can find the source for Koschei <a href="https://github.com/msimacek/koschei">here on GitHub.</a>
                    <a href="http://fedorahosted.org/koji/">
                        <img src="{{ url_for('static', filename='images/powered-by-koji.png') }}"
                        alt="Powered By Koji" id="PoweredByKojiLogo"/>
                    </a>
                </p>
            </div>
        </div>
    </body>
</html>
